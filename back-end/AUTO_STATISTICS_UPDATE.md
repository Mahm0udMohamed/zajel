# ุชุญุฏูุซ ุชููุงุฆู ููุฅุญุตุงุฆูุงุช - Product Statistics Auto-Update

## ๐ ูุธุฑุฉ ุนุงูุฉ

ุชู ุฅุถุงูุฉ ูุธุงู ุงูุชุญุฏูุซ ุงูุชููุงุฆู ูุฅุญุตุงุฆูุงุช ุงูููุชุฌุงุช ูู ุงูุจุงู ุฅูุฏ ูุถูุงู ุฏูุฉ ุงูุจูุงูุงุช ุฏูู ุงูุญุงุฌุฉ ูุชุฏุฎู ูุฏูู.

## ๐ ุงูููุฒุงุช ุงููุถุงูุฉ

### 1. ุงููุดุงูุฏุงุช ุงูุชููุงุฆูุฉ (Auto View Count)

- **ุงููุธููุฉ**: ุชุฒูุฏ ุงููุดุงูุฏุงุช ุชููุงุฆูุงู ุนูุฏ ุฌูุจ ููุชุฌ ูุญุฏุฏ
- **ุงูููู**: `controllers/productController.js` - ุฏุงูุฉ `getProductById`
- **ุงูุทุฑููุฉ**: `Product.incrementViewsOnGet(productId)`
- **ุงูููุงุกุฉ**: ุชุณุชุฎุฏู `$inc` operator ูุฒูุงุฏุฉ ุงูุฃุฏุงุก

### 2. ุงููุดุชุฑูุงุช ุงูุชููุงุฆูุฉ (Auto Purchase Count)

- **ุงููุธููุฉ**: ุชุฒูุฏ ุงููุดุชุฑูุงุช ุชููุงุฆูุงู ุนูุฏ ุฅุชูุงู ุทูุจ
- **ุงูููู**: `controllers/productController.js` - ุฏุงูุฉ `incrementPurchasesForOrder`
- **ุงูุทุฑููุฉ**: `Product.incrementPurchasesOnOrder(productIds)`
- **ุงูููุงุกุฉ**: ุชุญุฏูุซ ูุฌูุน ูุนุฏุฉ ููุชุฌุงุช ูู ุนูููุฉ ูุงุญุฏุฉ

## ๐ง ุงูุชุญุฏูุซุงุช ุงูุชูููุฉ

### ูู `models/Product.js`:

```javascript
// ุฏูุงู ุฌุฏูุฏุฉ ูุถุงูุฉ
ProductSchema.statics.incrementViewsOnGet = async function (productId) {
  // ุฒูุงุฏุฉ ุงููุดุงูุฏุงุช ุจููุงุกุฉ
};

ProductSchema.statics.incrementPurchasesOnOrder = async function (productIds) {
  // ุฒูุงุฏุฉ ุงููุดุชุฑูุงุช ูุนุฏุฉ ููุชุฌุงุช
};
```

### ูู `controllers/productController.js`:

```javascript
// ุชุญุฏูุซ ุชููุงุฆู ูู getProductById
Product.incrementViewsOnGet(id);

// ุฏุงูุฉ ุฌุฏูุฏุฉ ูุฒูุงุฏุฉ ุงููุดุชุฑูุงุช
export const incrementPurchasesForOrder = async (req, res) => {
  // ุฒูุงุฏุฉ ุงููุดุชุฑูุงุช ูุนุฏุฉ ููุชุฌุงุช
};
```

### ูู `routes/productRoutes.js`:

```javascript
// Route ุฌุฏูุฏ ูุถุงูุฉ
router.patch("/increment-purchases", incrementPurchasesForOrder);
```

## ๐ก API Endpoints ุงูุฌุฏูุฏุฉ

### 1. ุฒูุงุฏุฉ ุงููุดุชุฑูุงุช ูุนุฏุฉ ููุชุฌุงุช

```
PATCH /api/products/increment-purchases
Content-Type: application/json

{
  "productIds": ["productId1", "productId2", "productId3"]
}
```

**ุงูุงุณุชุฌุงุจุฉ:**

```json
{
  "success": true,
  "message": "ุชู ุชุญุฏูุซ ุฅุญุตุงุฆูุงุช ุงููุดุชุฑูุงุช ุจูุฌุงุญ"
}
```

## ๐ฏ ููููุฉ ุงูุงุณุชุฎุฏุงู

### 1. ูููุดุงูุฏุงุช:

- **ุชููุงุฆู**: ุนูุฏ ุงุณุชุฏุนุงุก `GET /api/products/:id`
- **ูุฏูู**: `PATCH /api/products/:id/views`

### 2. ูููุดุชุฑูุงุช:

- **ุชููุงุฆู**: ุงุณุชุฏุนุงุก `PATCH /api/products/increment-purchases` ุนูุฏ ุฅุชูุงู ุงูุทูุจ
- **ูุฏูู**: `PATCH /api/products/:id/purchases`

## โก ุงููููุฒุงุช

### 1. ุงูููุงุกุฉ:

- ุงุณุชุฎุฏุงู `$inc` operator ุจุฏูุงู ูู `findByIdAndUpdate`
- ุชุญุฏูุซ ูุฌูุน ูููุดุชุฑูุงุช
- ุนุฏู ุฅุนุงุฏุฉ ุฌูุจ ุงูุจูุงูุงุช ุบูุฑ ุงูุถุฑูุฑูุฉ

### 2. ุงูุฃูุงู:

- ูุนุงูุฌุฉ ุงูุฃุฎุทุงุก ุงูุดุงููุฉ
- ุงูุชุญูู ูู ุตุญุฉ ุงูุจูุงูุงุช
- ุฑุณุงุฆู ุฎุทุฃ ูุงุถุญุฉ

### 3. ุงููุฑููุฉ:

- ูุนูู ูุน ุงููุงุด
- ูุง ูุคุซุฑ ุนูู ุงูุฃุฏุงุก
- ุณูู ุงูุชุฎุตูุต

## ๐ ุชุฏูู ุงูุนูู

### ูููุดุงูุฏุงุช:

```
1. ุงููุณุชุฎุฏู ูุฒูุฑ ุตูุญุฉ ุงูููุชุฌ
2. Frontend ูุณุชุฏุนู GET /api/products/:id
3. Backend ูุฒูุฏ viewCount ุชููุงุฆูุงู
4. ุฅุฑุฌุงุน ุจูุงูุงุช ุงูููุชุฌ ูุน ุงูุฅุญุตุงุฆูุงุช ุงููุญุฏุซุฉ
```

### ูููุดุชุฑูุงุช:

```
1. ุงููุณุชุฎุฏู ูููู ุงูุทูุจ
2. Frontend ูุณุชุฏุนู PATCH /api/products/increment-purchases
3. Backend ูุฒูุฏ purchaseCount ูุฌููุน ุงูููุชุฌุงุช
4. ุชุฃููุฏ ูุฌุงุญ ุงูุนูููุฉ
```

## ๐ ุงูููุงุฆุฏ

1. **ุฏูุฉ ุงูุจูุงูุงุช**: ุฅุญุตุงุฆูุงุช ุญููููุฉ ููุญุฏุซุฉ
2. **ุณูููุฉ ุงูุงุณุชุฎุฏุงู**: ูุง ุญุงุฌุฉ ูุชุฏุฎู ูุฏูู
3. **ุงูุฃุฏุงุก**: ุชุญุฏูุซุงุช ุณุฑูุนุฉ ููุนุงูุฉ
4. **ุงูููุซูููุฉ**: ูุนุงูุฌุฉ ุดุงููุฉ ููุฃุฎุทุงุก
5. **ุงููุงุจููุฉ ููุชูุณุน**: ูุฏุนู ุนุฏุฏ ูุจูุฑ ูู ุงูููุชุฌุงุช

## ๐จ ููุงุญุธุงุช ูููุฉ

1. **ุงููุดุงูุฏุงุช**: ุชุฒูุฏ ุนูุฏ ุฌูุจ ููุชุฌ ูุญุฏุฏ ููุท (ููุณ ุนูุฏ ุนุฑุถ ูุงุฆูุฉ ุงูููุชุฌุงุช)
2. **ุงููุดุชุฑูุงุช**: ุชุญุชุงุฌ ุงุณุชุฏุนุงุก ุตุฑูุญ ูู Frontend ุนูุฏ ุฅุชูุงู ุงูุทูุจ
3. **ุงููุงุด**: ูุนูู ูุน ูุธุงู ุงููุงุด ุงูููุฌูุฏ
4. **ุงูุฃุฏุงุก**: ูุง ูุคุซุฑ ุนูู ุณุฑุนุฉ ุงูุงุณุชุฌุงุจุฉ

## ๐ง ุงูุชุฎุตูุต

ูููู ุชุฎุตูุต ุงููุธุงู ุนุจุฑ:

- ุชุนุฏูู `incrementViewsOnGet` ูุฒูุงุฏุฉ ุงููุดุงูุฏุงุช ูู ููุงุฆู ุงูููุชุฌุงุช
- ุฅุถุงูุฉ ููุงุชุฑ ูุชุฌูุจ ุฒูุงุฏุฉ ุงููุดุงูุฏุงุช ุงูููุฑุฑุฉ
- ุฅุถุงูุฉ ุชุณุฌูู ููุตู ููุนูููุงุช

---

**ุชุงุฑูุฎ ุงูุชุญุฏูุซ**: ููุงูุฑ 2025  
**ุงููุทูุฑ**: AI Assistant  
**ุงูุฅุตุฏุงุฑ**: 1.0.0
