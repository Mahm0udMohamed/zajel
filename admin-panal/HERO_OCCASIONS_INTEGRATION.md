# Hero Occasions Integration - دليل الربط

## نظرة عامة

تم ربط مناسبات الهيرو في لوحة التحكم مع الباك إند بنجاح. الآن يمكن إدارة المناسبات مباشرة من لوحة التحكم.

## المكونات المحدثة

### 1. خدمات API (`src/services/api.ts`)

تم إضافة الدوال التالية:

- `getHeroOccasions()` - الحصول على جميع المناسبات
- `getHeroOccasionById(id)` - الحصول على مناسبة واحدة
- `createHeroOccasion(data)` - إنشاء مناسبة جديدة
- `updateHeroOccasion(id, data)` - تحديث مناسبة موجودة
- `deleteHeroOccasion(id)` - حذف مناسبة
- `toggleHeroOccasionStatus(id)` - تبديل حالة المناسبة
- `importHeroOccasions(occasions)` - استيراد مناسبات

### 2. أنواع البيانات (`src/types/hero.ts`)

تم تحديث `HeroOccasion` interface لتشمل:

- `priority` - الأولوية (1-10)
- `createdBy` - منشئ المناسبة
- `updatedBy` - آخر من حدث المناسبة

### 3. مكون مناسبات الهيرو (`src/components/hero/HeroOccasionsTab.tsx`)

تم تحديث المكون ليتعامل مع الباك إند مباشرة:

- تحميل البيانات من الباك إند
- إضافة مناسبات جديدة
- تحديث المناسبات الموجودة
- حذف المناسبات
- تبديل حالة المناسبات
- إضافة حقل الأولوية
- حالة التحميل والأخطاء

### 4. صفحة المحتوى (`src/pages/ContentPage.tsx`)

تم تبسيط المكون لإزالة الـ props غير الضرورية.

### 5. إعدادات Vite (`vite.config.ts`)

تم إضافة متغير البيئة `VITE_API_URL` للإشارة إلى الباك إند.

## كيفية الاستخدام

### 1. تشغيل الباك إند

```bash
cd back-end
npm run dev:https
```

### 2. تشغيل لوحة التحكم

```bash
cd admin-panal
npm run dev
```

### 3. الوصول للوحة التحكم

- URL: `https://localhost:5174`
- تسجيل الدخول باستخدام بيانات المدير
- الانتقال إلى "إدارة المحتوى" > "الهيرو" > "مناسبات الهيرو"

## الميزات المتاحة

### إدارة المناسبات

- ✅ عرض جميع المناسبات
- ✅ إضافة مناسبة جديدة
- ✅ تعديل مناسبة موجودة
- ✅ حذف مناسبة
- ✅ تبديل حالة المناسبة (نشط/غير نشط)
- ✅ إدارة الصور
- ✅ إدارة رسائل التهنئة
- ✅ إدارة الأولوية

### واجهة المستخدم

- ✅ تصميم متجاوب
- ✅ حالة التحميل
- ✅ رسائل الخطأ والنجاح
- ✅ تأكيد الحذف
- ✅ معاينة الصور

## هيكل البيانات

### HeroOccasion

```typescript
{
  id: string;                    // معرف فريد
  nameAr: string;               // الاسم بالعربية
  nameEn: string;               // الاسم بالإنجليزية
  date: string;                 // تاريخ المناسبة
  images: string[];             // مصفوفة روابط الصور
  celebratoryMessageAr: string; // الرسالة التهنئة بالعربية
  celebratoryMessageEn: string; // الرسالة التهنئة بالإنجليزية
  priority: number;             // الأولوية (1-10)
  isActive: boolean;            // حالة التفعيل
  createdBy?: {                 // منشئ المناسبة
    _id: string;
    name: string;
    email: string;
  };
  updatedBy?: {                 // آخر من حدث المناسبة
    _id: string;
    name: string;
    email: string;
  };
  createdAt?: string;           // تاريخ الإنشاء
  updatedAt?: string;           // تاريخ آخر تحديث
}
```

## الأمان

- جميع عمليات الإنشاء والتحديث والحذف محمية بمصادقة المدير
- التحقق من صحة البيانات المدخلة
- تسجيل جميع التغييرات مع معرف المستخدم

## استكشاف الأخطاء

### مشاكل الاتصال

- تأكد من أن الباك إند يعمل على `https://localhost:3002`
- تحقق من إعدادات CORS
- تأكد من صحة الشهادات SSL

### مشاكل المصادقة

- تأكد من تسجيل الدخول كمدير
- تحقق من صحة التوكن
- تأكد من إرسال التوكن في الهيدر

### مشاكل البيانات

- تحقق من صحة البيانات المدخلة
- تأكد من وجود جميع الحقول المطلوبة
- تحقق من صحة تنسيق التاريخ

## التطوير المستقبلي

- إضافة إمكانية رفع الصور مباشرة
- إضافة إمكانية استيراد من ملف JSON
- إضافة إحصائيات المناسبات
- إضافة إمكانية نسخ المناسبات
- إضافة إمكانية ترتيب المناسبات بالسحب والإفلات

---

**ملاحظة**: هذا النظام مصمم لاستبدال ملف `heroOccasions.json` الثابت بنظام ديناميكي يدعم إدارة كاملة للبيانات من لوحة التحكم.
