# إعداد لوحة التحكم الآمنة

## نظرة عامة

تم تحديث لوحة التحكم لتصبح آمنة ومتصلة بنظام المصادقة في الباك اند.

## الملفات المضافة/المحدثة

### 1. خدمة API

- `src/services/api.ts` - خدمة للتواصل مع الباك اند

### 2. Context للمصادقة

- `src/contexts/AdminAuthContext.tsx` - إدارة حالة المصادقة

### 3. مكونات الحماية

- `src/components/ProtectedRoute.tsx` - حماية الصفحات
- `src/components/LoginForm.tsx` - تحديث نموذج تسجيل الدخول
- `src/components/AdminHeader.tsx` - إضافة زر تسجيل الخروج

### 4. التطبيق الرئيسي

- `src/App.tsx` - تحديث لاستخدام AuthContext وProtectedRoute

## إعداد النظام

### 1. إعداد متغيرات البيئة

أنشئ ملف `.env` في مجلد `admin-panal`:

```env
VITE_API_URL=https://localhost:3002/api
```

### 2. تشغيل الباك اند

```bash
cd back-end
npm run dev
```

### 3. تشغيل لوحة التحكم

```bash
cd admin-panal
npm run dev
```

## الميزات الأمنية

### 1. مصادقة آمنة

- تسجيل دخول آمن باستخدام JWT tokens
- تحديث تلقائي للتوكنات
- حماية من انتهاء الجلسة

### 2. حماية الصفحات

- جميع الصفحات محمية بـ ProtectedRoute
- إعادة توجيه تلقائي لصفحة تسجيل الدخول
- تحقق من صحة التوكن في كل طلب

### 3. إدارة الجلسة

- حفظ التوكنات في localStorage
- تحديث تلقائي للتوكنات المنتهية الصلاحية
- تسجيل خروج آمن

## كيفية الاستخدام

### 1. تسجيل الدخول

- افتح لوحة التحكم
- أدخل البريد الإلكتروني وكلمة المرور
- سيتم تسجيل الدخول تلقائياً

### 2. التنقل

- جميع الصفحات محمية
- يمكن الوصول إليها فقط بعد تسجيل الدخول
- زر تسجيل الخروج في الهيدر

### 3. تسجيل الخروج

- اضغط على زر تسجيل الخروج في الهيدر
- سيتم مسح التوكنات وإعادة التوجيه

## استكشاف الأخطاء

### 1. خطأ الاتصال بالباك اند

- تأكد من تشغيل الباك اند على المنفذ 3002
- تحقق من عنوان API في ملف .env

### 2. خطأ المصادقة

- تأكد من صحة بيانات تسجيل الدخول
- تحقق من وجود المدير في قاعدة البيانات

### 3. انتهاء الجلسة

- سيتم تحديث التوكن تلقائياً
- إذا فشل التحديث، سيتم إعادة التوجيه لتسجيل الدخول

## ملاحظات مهمة

1. تأكد من تشغيل الباك اند قبل لوحة التحكم
2. استخدم HTTPS في الإنتاج
3. احتفظ بمعلومات المدير في مكان آمن
4. قم بتغيير كلمة المرور الافتراضية فوراً
